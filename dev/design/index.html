<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Design · Descartes</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Descartes</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../primitives/">Primitives</a></li><li class="current"><a class="toctext" href>Design</a><ul class="internal"><li><a class="toctext" href="#Implicit-Geometry-Pipeline-1">Implicit Geometry Pipeline</a></li><li><a class="toctext" href="#UX-1">UX</a></li><li><a class="toctext" href="#Meshing-1">Meshing</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Design</a></li></ul><a class="edit-page" href="https://github.com/sjkelly/Descartes.jl/blob/master/docs/src/design.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Design</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Design-Overview-1" href="#Design-Overview-1">Design Overview</a></h1><p>Descartes current uses implicit modeling to create solid models. This is a brief overview of the system internals.</p><h2><a class="nav-anchor" id="Implicit-Geometry-Pipeline-1" href="#Implicit-Geometry-Pipeline-1">Implicit Geometry Pipeline</a></h2><h2><a class="nav-anchor" id="UX-1" href="#UX-1">UX</a></h2><p>The UX (API) is designed to be familiar to those who use OpenSCAD. Let&#39;s start with a simple example to show the similarities.</p><p>This can all be executed in the Julia REPL, so follow along:</p><pre><code class="language-julia">using Descartes

c = Cuboid([5,5,5])

h = translate([2.5,2.5,0])Cylinder(1,5)

obj = diff(c,h)

m = HomogenousMesh(obj)

save(&quot;cube_with_hole.stl&quot;, m)</code></pre><p>This first line:</p><pre><code class="language-julia">using Descartes</code></pre><p>This imports the Descartes library.</p><pre><code class="language-julia">c = Cuboid([5,5,5])</code></pre><p>Here we construct a cube of size 5x5x5.</p><pre><code class="language-julia">h = translate([2.5,2.5,0])Cylinder(1,5)</code></pre><p>This line shows the OpenSCADisms. This can be read right-to-left like a matrix operation. First we construct a cylinder of radius 1, and height 5. Next we translate the cylinder to the coordinates 2.5, 2.5, 0 to put it in the center of our cube.</p><pre><code class="language-julia">obj = diff(c,h)</code></pre><p>Here we difference the cylinder from the cube. The corresponding set operations are <code>union</code> and <code>intersect</code>.</p><pre><code class="language-julia">m = HomogenousMesh(obj)</code></pre><p>At this point we convert our object to a mesh. Prior to this point the model is simply a data structure. In the next section we will discuss the process of meshign more in-depth.</p><pre><code class="language-julia">save(&quot;cube_with_hole.stl&quot;, m)</code></pre><p>Finally we save the mesh as an STL. Other formats such as OBJ, PLY, and OFF are also supported.</p><h2><a class="nav-anchor" id="Meshing-1" href="#Meshing-1">Meshing</a></h2><p>In the prior section we mentioned that the &quot;model&quot; we create is just a data structure until we mesh it. So let&#39;s explore what happens in the meshing process.</p><p>The code to convert our data structure to a mesh is actually fairly short:</p><p><a href="https://github.com/sjkelly/Descartes.jl/blob/master/src/meshes.jl">Current version</a></p><pre><code class="language-julia">function (::Type{MT})(primitives::AbstractPrimitive{3, T}...;
                                         samples=(128,128,128),
                                         algorithm=MarchingCubes()
                                         ) where {T, MT &lt;: AbstractMesh}

    f(x) = FRep(primitives[1], x)
    mesh = MT(f, HyperRectangle(primitives[1]), samples, algorithm)

    for i = 2:length(primitives)
        b = HyperRectangle(primitives[i])
        lm = MT(x -&gt; FRep(primitives[i], x), b, samples, algorithm)
        mesh = merge(mesh, lm)
    end

    return mesh
end</code></pre><p>The first two lines here are where the meshing happens:</p><pre><code class="language-julia">    f(x) = FRep(primitives[1], x)
    mesh = MT(f, HyperRectangle(primitives[1]), samples, algorithm)</code></pre><p>Any primitve or operation must implement two core operations; <code>FRep</code> and <code>HyperRectangle</code>.</p><p><code>FRep</code> is the functional representation (implicit representation) of the model. The first argument to <code>FRep</code> is always the primitive. The second is a generic <code>AbstractVector</code>. In julia we have type inference, so we do not need to annotate, so this will always be fast. FRep by convention must use 0 as the surface of the model, positive outside the model, and negative inside.</p><p><code>HyperRectangle</code> should return the extents of the primitive. The underlying API will handle transformations and basic set operations for us.</p><p>In the next line we actually perform the meshing operation. We call the meshtype with the implicit function we created, <code>f</code>, in the bounds generated by <code>HyperRectangle</code>, uniformly sample the space by <code>samples</code>, and actually generate the triangular meshing using <code>algorithm</code>. In this case, the defaults are <code>samples=(128,128,128)</code> and <code>algorithm=MarchingCubes()</code>.</p><p>In the loop <code>for i = 2:length(primitives) ... end</code> we handle additional primitives passed to our meshing function so you can create a single mesh output from several different objects. In order to maintain performance and resolution these are not <code>union</code>ed.</p><footer><hr/><a class="previous" href="../primitives/"><span class="direction">Previous</span><span class="title">Primitives</span></a></footer></article></body></html>
